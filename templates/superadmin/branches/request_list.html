{% extends 'superadmin/base.html' %}

{% block title %}Branch Requests - {{ business.company_name }}{% endblock %}

{% block superadmin_content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Branch Requests for {{ business.company_name }}</h1>
  <div>
    <a href="{% url 'superadmin:branch_request_create' %}" class="btn btn-primary">
      <i class="fas fa-plus me-1"></i> Request New Branch
    </a>
    <a href="{% url 'superadmin:branch_list' business.pk %}" class="btn btn-secondary ms-2">
      <i class="fas fa-arrow-left me-1"></i> Back to Branches
    </a>
  </div>
</div>

<!-- Branch Request List -->
<div class="card">
  <div class="card-header">
    <h5 class="mb-0">All Branch Requests</h5>
  </div>
  <div class="table-responsive">
    <table class="table table-hover mb-0">
      <thead>
        <tr>
          <th>Name</th>
          <th>Address</th>
          <th>Contact</th>
          <th>Main Branch</th>
          <th>Status</th>
          <th>Requested</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for request in branch_requests %}
        <tr>
          <td>{{ request.name }}</td>
          <td>{{ request.address|truncatewords:10 }}</td>
          <td>
            {% if request.phone %}<div><i class="fas fa-phone me-1"></i> {{ request.phone }}</div>{% endif %}
            {% if request.email %}<div><i class="fas fa-envelope me-1"></i> {{ request.email }}</div>{% endif %}
          </td>
          <td>
            {% if request.is_main %}
              <span class="badge bg-primary">Main</span>
            {% else %}
              <span class="badge bg-secondary">Secondary</span>
            {% endif %}
          </td>
          <td>
            {% if request.status == 'pending' %}
              <span class="badge bg-warning">Pending</span>
            {% elif request.status == 'approved' %}
              <span class="badge bg-success">Approved</span>
            {% else %}
              <span class="badge bg-danger">Rejected</span>
            {% endif %}
          </td>
          <td>
            {{ request.requested_at|date:"M d, Y" }}
            <div class="small text-muted">
              by {{ request.requested_by.username }}
            </div>
          </td>
          <td>
            <div class="btn-group btn-group-sm" role="group">
              <a href="{% url 'superadmin:branch_request_detail' request.pk %}" class="btn btn-outline-info" title="View Details">
                <i class="fas fa-eye"></i>
              </a>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="7" class="text-center">No branch requests found</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Branch Request Statistics -->
<div class="row mt-4">
  <div class="col-md-4">
    <div class="card">
      <div class="card-body text-center">
        <h5 class="card-title">{{ branch_requests|length }}</h5>
        <p class="card-text">Total Requests</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-body text-center">
        <h5 class="card-title">N/A</h5>
        <p class="card-text">Pending Requests</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-body text-center">
        <h5 class="card-title">N/A</h5>
        <p class="card-text">Approved Requests</p>
      </div>
    </div>
  </div>
</div>
{% endblock %}