{% extends 'superadmin/base.html' %}

{% block title %}Branch Request Approvals - Super Admin{% endblock %}

{% block superadmin_content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Pending Branch Requests</h1>
  <div>
    <a href="{% url 'superadmin:dashboard' %}" class="btn btn-secondary">
      <i class="fas fa-arrow-left me-1"></i> Back to Dashboard
    </a>
  </div>
</div>

<!-- Pending Branch Requests -->
<div class="card">
  <div class="card-header">
    <h5 class="mb-0">Pending Branch Requests</h5>
  </div>
  <div class="table-responsive">
    <table class="table table-hover mb-0">
      <thead>
        <tr>
          <th>Business</th>
          <th>Branch Name</th>
          <th>Address</th>
          <th>Contact</th>
          <th>Main Branch</th>
          <th>Requested By</th>
          <th>Requested At</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for request in pending_requests %}
        <tr>
          <td>{{ request.business.company_name }}</td>
          <td>{{ request.name }}</td>
          <td>{{ request.address|truncatewords:10 }}</td>
          <td>
            {% if request.phone %}<div><i class="fas fa-phone me-1"></i> {{ request.phone }}</div>{% endif %}
            {% if request.email %}<div><i class="fas fa-envelope me-1"></i> {{ request.email }}</div>{% endif %}
          </td>
          <td>
            {% if request.is_main %}
              <span class="badge bg-primary">Main</span>
            {% else %}
              <span class="badge bg-secondary">Secondary</span>
            {% endif %}
          </td>
          <td>
            {{ request.requested_by.username }}
            <div class="small text-muted">
              {{ request.requested_by.email }}
            </div>
          </td>
          <td>{{ request.requested_at|date:"M d, Y H:i" }}</td>
          <td>
            <div class="btn-group btn-group-sm" role="group">
              <a href="{% url 'superadmin:branch_request_detail' request.pk %}" class="btn btn-outline-info" title="View Details">
                <i class="fas fa-eye"></i>
              </a>
              <a href="{% url 'superadmin:branch_request_approve' request.pk %}" class="btn btn-outline-success" title="Approve/Reject">
                <i class="fas fa-check-circle"></i>
              </a>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="text-center">No pending branch requests</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Statistics -->
<div class="row mt-4">
  <div class="col-md-4">
    <div class="card">
      <div class="card-body text-center">
        <h5 class="card-title">{{ pending_requests|length }}</h5>
        <p class="card-text">Pending Requests</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-body text-center">
        <h5 class="card-title">N/A</h5>
        <p class="card-text">Main Branch Requests</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-body text-center">
        <h5 class="card-title">N/A</h5>
        <p class="card-text">Businesses with Requests</p>
      </div>
    </div>
  </div>
</div>
{% endblock %}